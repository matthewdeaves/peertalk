{
  "timestamp": "2026-02-08T13:21:02.239906Z",
  "commit": "3f82918",
  "branch": "develop",
  "test_results": {
    "total_tests": 28,
    "passed": 28,
    "failed": 0,
    "pass_rate": 100.0,
    "test_details": [
      {
        "file": "test_unknown.c",
        "name": "test_create_destroy...",
        "status": "PASS"
      },
      {
        "file": "test_unknown.c",
        "name": "test_level_filtering...",
        "status": "PASS"
      },
      {
        "file": "test_unknown.c",
        "name": "test_category_filtering...",
        "status": "PASS"
      },
      {
        "file": "test_unknown.c",
        "name": "test_formatting...",
        "status": "PASS"
      },
      {
        "file": "test_unknown.c",
        "name": "test_file_output...",
        "status": "PASS"
      },
      {
        "file": "test_unknown.c",
        "name": "test_elapsed_time...",
        "status": "PASS"
      },
      {
        "file": "test_unknown.c",
        "name": "test_sequence_numbers...",
        "status": "PASS"
      },
      {
        "file": "test_unknown.c",
        "name": "test_performance_logging...",
        "status": "PASS"
      },
      {
        "file": "test_unknown.c",
        "name": "test_level_names...",
        "status": "PASS"
      },
      {
        "file": "test_unknown.c",
        "name": "test_version...",
        "status": "PASS"
      },
      {
        "file": "test_unknown.c",
        "name": "test_callback_user_data...",
        "status": "PASS"
      },
      {
        "file": "test_unknown.c",
        "name": "test_output_combinations...",
        "status": "PASS"
      },
      {
        "file": "test_unknown.c",
        "name": "test_perf_sequence...",
        "status": "PASS"
      },
      {
        "file": "test_unknown.c",
        "name": "test_perf_with_text_log...",
        "status": "PASS"
      },
      {
        "file": "test_unknown.c",
        "name": "test_multiple_outputs...",
        "status": "PASS"
      },
      {
        "file": "test_unknown.c",
        "name": "test_app_categories...",
        "status": "PASS"
      },
      {
        "file": "test_unknown.c",
        "name": "test_perf_category_field...",
        "status": "PASS"
      },
      {
        "file": "test_unknown.c",
        "name": "version_string...",
        "status": "PASS"
      },
      {
        "file": "test_unknown.c",
        "name": "version_constants...",
        "status": "PASS"
      },
      {
        "file": "test_unknown.c",
        "name": "error_strings...",
        "status": "PASS"
      },
      {
        "file": "test_unknown.c",
        "name": "error_string_content...",
        "status": "PASS"
      },
      {
        "file": "test_unknown.c",
        "name": "protocol_constants...",
        "status": "PASS"
      },
      {
        "file": "test_unknown.c",
        "name": "default_ports...",
        "status": "PASS"
      },
      {
        "file": "test_unknown.c",
        "name": "platform_ticks...",
        "status": "PASS"
      },
      {
        "file": "test_unknown.c",
        "name": "platform_memory...",
        "status": "PASS"
      },
      {
        "file": "test_unknown.c",
        "name": "dod_struct_sizes...",
        "status": "PASS"
      },
      {
        "file": "test_unknown.c",
        "name": "dod_lookup_table...",
        "status": "PASS"
      },
      {
        "file": "test_unknown.c",
        "name": "init_null_config...",
        "status": "PASS"
      }
    ]
  },
  "coverage": {
    "line_coverage": 71.3,
    "function_coverage": 91.7,
    "lines_covered": 2081,
    "lines_total": 2919,
    "functions_covered": 176,
    "functions_total": 192
  },
  "isr_safety": {
    "total_violations": 0,
    "by_category": {},
    "violations": []
  },
  "quality": {
    "files_over_500_lines": 14,
    "todo_count": 4,
    "fixme_count": 0,
    "compiler_warnings": 0
  },
  "ci_metrics": {
    "workflow_name": "PeerTalk CI",
    "build_duration_sec": 1,
    "test_duration_sec": 69,
    "coverage_duration_sec": 69,
    "total_duration_sec": 139,
    "jobs": {
      "build-posix": {
        "status": "success",
        "duration_sec": 1
      },
      "validate-isr-safety": {
        "status": "success",
        "duration_sec": 0
      },
      "quality-gates": {
        "status": "success",
        "duration_sec": 0
      }
    }
  },
  "binary_size": {
    "libpeertalk_bytes": 524532,
    "libptlog_bytes": 38882,
    "total_lib_bytes": 563414,
    "core_obj_bytes": 331144,
    "posix_obj_bytes": 189328,
    "log_obj_bytes": 38360,
    "total_obj_bytes": 558832,
    "source_files": 23,
    "source_lines": 13195,
    "header_files": 2,
    "header_lines": 1360,
    "total_lines": 14555
  },
  "complexity": {
    "tool": "pmccabe",
    "max_complexity": 15,
    "total_functions": 332,
    "functions_over_threshold": 11,
    "highest_complexity": 48,
    "average_complexity": 4.8,
    "violations": [
      {
        "function": "pt_peer_set_state",
        "file": "src/core/peer.c",
        "line": 377,
        "complexity": 16
      },
      {
        "function": "pt_discovery_decode",
        "file": "src/core/protocol.c",
        "line": 138,
        "complexity": 20
      },
      {
        "function": "pt_format_int",
        "file": "src/core/pt_compat.c",
        "line": 393,
        "complexity": 24
      },
      {
        "function": "pt_vsnprintf",
        "file": "src/core/pt_compat.c",
        "line": 466,
        "complexity": 24
      },
      {
        "function": "PeerTalk_Init",
        "file": "src/core/pt_init.c",
        "line": 20,
        "complexity": 23
      },
      {
        "function": "pt_queue_push",
        "file": "src/core/queue.c",
        "line": 101,
        "complexity": 18
      },
      {
        "function": "PeerTalk_SendEx",
        "file": "src/core/send.c",
        "line": 334,
        "complexity": 35
      },
      {
        "function": "pt_mactcp_tcp_recv",
        "file": "src/mactcp/tcp_io.c",
        "line": 214,
        "complexity": 46
      },
      {
        "function": "pt_posix_discovery_poll",
        "file": "src/posix/net_posix.c",
        "line": 519,
        "complexity": 16
      },
      {
        "function": "pt_posix_send_with_flags",
        "file": "src/posix/net_posix.c",
        "line": 1143,
        "complexity": 17
      },
      {
        "function": "pt_posix_poll",
        "file": "src/posix/net_posix.c",
        "line": 2279,
        "complexity": 48
      }
    ]
  },
  "test_count": {
    "timestamp": "2026-02-08T13:20:53Z",
    "summary": {
      "total_tests": 259,
      "test_files": 38,
      "passed": 11,
      "failed": 0
    },
    "by_file": {
      "test_api_errors.c": 37,
      "test_backpressure.c": 0,
      "test_batch_send.c": 10,
      "test_bidirectional.c": 7,
      "test_compat.c": 15,
      "test_connect_posix.c": 0,
      "test_connection.c": 16,
      "test_direct_buffer.c": 14,
      "test_discovery_posix.c": 0,
      "test_discovery_recv.c": 8,
      "test_error_strings.c": 3,
      "test_foundation.c": 16,
      "test_helpers.c": 0,
      "test_integration_full.c": 0,
      "test_integration_posix.c": 0,
      "test_isr_safety_compile.c": 0,
      "test_isr_safety_mactcp.c": 0,
      "test_isr_safety_ot.c": 0,
      "test_log_perf.c": 0,
      "test_log_posix.c": 0,
      "test_log_threads.c": 0,
      "test_loopback_messaging.c": 12,
      "test_messaging_posix.c": 0,
      "test_peer.c": 9,
      "test_perf_benchmarks.c": 10,
      "test_protocol.c": 22,
      "test_protocol_fuzz.c": 20,
      "test_protocol_messaging.c": 6,
      "test_queue.c": 12,
      "test_queue_advanced.c": 0,
      "test_queue_extended.c": 9,
      "test_queue_threads.c": 4,
      "test_queue_unity.c": 11,
      "test_sendex.c": 0,
      "test_stats_posix.c": 0,
      "test_tcp_send_recv.c": 7,
      "test_two_tier_queue.c": 11,
      "test_udp_posix.c": 0
    },
    "categories": {
      "unit_tests": 33,
      "integration_tests": 2,
      "performance_tests": 2,
      "fuzz_tests": 1
    }
  },
  "static_analysis": {
    "tool": "cppcheck",
    "version": "Cppcheck 2.7",
    "total_issues": 31,
    "by_severity": {
      "information": 20,
      "style": 11
    },
    "issues": [
      {
        "id": "variableScope",
        "severity": "style",
        "message": "The scope of the variable 'frag_flags' can be reduced.",
        "file": "src/core/send.c",
        "line": 401
      },
      {
        "id": "variableScope",
        "severity": "style",
        "message": "The scope of the variable 'frag_result' can be reduced.",
        "file": "src/core/send.c",
        "line": 402
      },
      {
        "id": "constParameter",
        "severity": "style",
        "message": "Parameter 'peer' can be declared with const",
        "file": "src/mactcp/tcp_connect.c",
        "line": 99
      },
      {
        "id": "variableScope",
        "severity": "style",
        "message": "The scope of the variable 'data_ptr' can be reduced.",
        "file": "src/mactcp/tcp_io.c",
        "line": 219
      },
      {
        "id": "variableScope",
        "severity": "style",
        "message": "The scope of the variable 'crc_expected' can be reduced.",
        "file": "src/mactcp/tcp_io.c",
        "line": 220
      },
      {
        "id": "variableScope",
        "severity": "style",
        "message": "The scope of the variable 'crc_actual' can be reduced.",
        "file": "src/mactcp/tcp_io.c",
        "line": 220
      },
      {
        "id": "variableScope",
        "severity": "style",
        "message": "The scope of the variable 'rds_idx' can be reduced.",
        "file": "src/mactcp/tcp_io.c",
        "line": 225
      },
      {
        "id": "variableScope",
        "severity": "style",
        "message": "The scope of the variable 'expected_len' can be reduced.",
        "file": "src/mactcp/tcp_io.c",
        "line": 226
      },
      {
        "id": "knownConditionTrueFalse",
        "severity": "style",
        "message": "Condition 'hot->rds_outstanding' is always true",
        "file": "src/mactcp/tcp_io.c",
        "line": 327
      },
      {
        "id": "variableScope",
        "severity": "style",
        "message": "The scope of the variable 'effective_max' can be reduced.",
        "file": "src/mactcp/tcp_io.c",
        "line": 497
      },
      {
        "id": "variableScope",
        "severity": "style",
        "message": "The scope of the variable 'effective_max' can be reduced.",
        "file": "src/posix/net_posix.c",
        "line": 1815
      },
      {
        "id": "toomanyconfigs",
        "severity": "information",
        "message": "Too many #ifdef configurations - cppcheck only checks 12 of 19 configurations. Use --force to check all configurations.",
        "file": "src/core/peer.c",
        "line": 0
      },
      {
        "id": "toomanyconfigs",
        "severity": "information",
        "message": "Too many #ifdef configurations - cppcheck only checks 12 of 19 configurations. Use --force to check all configurations.",
        "file": "src/core/protocol.c",
        "line": 0
      },
      {
        "id": "toomanyconfigs",
        "severity": "information",
        "message": "Too many #ifdef configurations - cppcheck only checks 12 of 13 configurations. Use --force to check all configurations.",
        "file": "src/core/pt_compat.c",
        "line": 0
      },
      {
        "id": "toomanyconfigs",
        "severity": "information",
        "message": "Too many #ifdef configurations - cppcheck only checks 12 of 19 configurations. Use --force to check all configurations.",
        "file": "src/core/pt_init.c",
        "line": 0
      },
      {
        "id": "toomanyconfigs",
        "severity": "information",
        "message": "Too many #ifdef configurations - cppcheck only checks 12 of 20 configurations. Use --force to check all configurations.",
        "file": "src/core/pt_version.c",
        "line": 0
      },
      {
        "id": "toomanyconfigs",
        "severity": "information",
        "message": "Too many #ifdef configurations - cppcheck only checks 12 of 21 configurations. Use --force to check all configurations.",
        "file": "src/core/queue.c",
        "line": 0
      },
      {
        "id": "toomanyconfigs",
        "severity": "information",
        "message": "Too many #ifdef configurations - cppcheck only checks 12 of 19 configurations. Use --force to check all configurations.",
        "file": "src/core/send.c",
        "line": 0
      },
      {
        "id": "toomanyconfigs",
        "severity": "information",
        "message": "Too many #ifdef configurations - cppcheck only checks 12 of 19 configurations. Use --force to check all configurations.",
        "file": "src/mactcp/discovery_mactcp.c",
        "line": 0
      },
      {
        "id": "toomanyconfigs",
        "severity": "information",
        "message": "Too many #ifdef configurations - cppcheck only checks 12 of 19 configurations. Use --force to check all configurations.",
        "file": "src/mactcp/mactcp_driver.c",
        "line": 0
      },
      {
        "id": "toomanyconfigs",
        "severity": "information",
        "message": "Too many #ifdef configurations - cppcheck only checks 12 of 19 configurations. Use --force to check all configurations.",
        "file": "src/mactcp/mactcp_multi.c",
        "line": 0
      },
      {
        "id": "toomanyconfigs",
        "severity": "information",
        "message": "Too many #ifdef configurations - cppcheck only checks 12 of 19 configurations. Use --force to check all configurations.",
        "file": "src/mactcp/platform_mactcp.c",
        "line": 0
      },
      {
        "id": "toomanyconfigs",
        "severity": "information",
        "message": "Too many #ifdef configurations - cppcheck only checks 12 of 19 configurations. Use --force to check all configurations.",
        "file": "src/mactcp/poll_mactcp.c",
        "line": 0
      },
      {
        "id": "toomanyconfigs",
        "severity": "information",
        "message": "Too many #ifdef configurations - cppcheck only checks 12 of 19 configurations. Use --force to check all configurations.",
        "file": "src/mactcp/tcp_connect.c",
        "line": 0
      },
      {
        "id": "toomanyconfigs",
        "severity": "information",
        "message": "Too many #ifdef configurations - cppcheck only checks 12 of 19 configurations. Use --force to check all configurations.",
        "file": "src/mactcp/tcp_io.c",
        "line": 0
      },
      {
        "id": "toomanyconfigs",
        "severity": "information",
        "message": "Too many #ifdef configurations - cppcheck only checks 12 of 19 configurations. Use --force to check all configurations.",
        "file": "src/mactcp/tcp_listen.c",
        "line": 0
      },
      {
        "id": "toomanyconfigs",
        "severity": "information",
        "message": "Too many #ifdef configurations - cppcheck only checks 12 of 19 configurations. Use --force to check all configurations.",
        "file": "src/mactcp/tcp_mactcp.c",
        "line": 0
      },
      {
        "id": "toomanyconfigs",
        "severity": "information",
        "message": "Too many #ifdef configurations - cppcheck only checks 12 of 19 configurations. Use --force to check all configurations.",
        "file": "src/mactcp/udp_mactcp.c",
        "line": 0
      },
      {
        "id": "toomanyconfigs",
        "severity": "information",
        "message": "Too many #ifdef configurations - cppcheck only checks 12 of 19 configurations. Use --force to check all configurations.",
        "file": "src/opentransport/platform_ot.c",
        "line": 0
      },
      {
        "id": "toomanyconfigs",
        "severity": "information",
        "message": "Too many #ifdef configurations - cppcheck only checks 12 of 19 configurations. Use --force to check all configurations.",
        "file": "src/posix/net_posix.c",
        "line": 0
      },
      {
        "id": "toomanyconfigs",
        "severity": "information",
        "message": "Too many #ifdef configurations - cppcheck only checks 12 of 19 configurations. Use --force to check all configurations.",
        "file": "src/posix/platform_posix.c",
        "line": 0
      }
    ]
  },
  "duplicates": {
    "tool": "jscpd",
    "version": "3.5.10",
    "total_duplicates": 35,
    "total_lines": 10988,
    "duplicate_lines": 528,
    "percentage": 4.81,
    "clones": [
      {
        "lines": 12,
        "tokens": 0,
        "first_file": "src/mactcp/tcp_mactcp.c",
        "first_start": 211,
        "first_end": 222,
        "second_file": "src/mactcp/udp_mactcp.c",
        "second_start": 130,
        "second_end": 141,
        "fragment": "rror_code = 0;\n\n    /* Setup parameter block (in cold struct) */\n    pt_memset(&cold->pb, 0, sizeof(cold->pb));\n    cold->pb.csCode = TCPCreate;\n    cold->pb.ioCRefNum = md->driver_refnum;\n    cold->p"
      },
      {
        "lines": 8,
        "tokens": 0,
        "first_file": "src/mactcp/tcp_mactcp.c",
        "first_start": 311,
        "first_end": 318,
        "second_file": "src/mactcp/tcp_mactcp.c",
        "second_start": 210,
        "second_end": 221,
        "fragment": "ASR flags and log events */\n    hot->asr_flags = 0;\n    hot->log_events = 0;\n    hot->log_error_code = 0;\n\n    /* Setup parameter block */\n    pt_memset(&cold->pb, 0, sizeof(cold->pb));\n    cold->pb.c"
      },
      {
        "lines": 14,
        "tokens": 0,
        "first_file": "src/mactcp/tcp_mactcp.c",
        "first_start": 327,
        "first_end": 340,
        "second_file": "src/mactcp/tcp_mactcp.c",
        "second_start": 242,
        "second_end": 253,
        "fragment": "(ParmBlkPtr)&cold->pb);\n\n    if (err != noErr) {\n        PT_LOG_ERR(ctx->log, PT_LOG_CAT_CONNECT,\n            \"TCPCreate (listener) failed: %d\", (int)err);\n        pt_mactcp_free_buffer(cold->rcv_buff"
      },
      {
        "lines": 18,
        "tokens": 0,
        "first_file": "src/mactcp/tcp_mactcp.c",
        "first_start": 437,
        "first_end": 454,
        "second_file": "src/mactcp/tcp_mactcp.c",
        "second_start": 374,
        "second_end": 391,
        "fragment": "data *md = pt_mactcp_get(ctx);\n    pt_tcp_stream_hot *hot = &md->listener_hot;\n    pt_tcp_stream_cold *cold = &md->listener_cold;\n    OSErr err;\n\n    if (hot->state == PT_STREAM_UNUSED)\n        return"
      },
      {
        "lines": 18,
        "tokens": 0,
        "first_file": "src/mactcp/tcp_mactcp.c",
        "first_start": 454,
        "first_end": 471,
        "second_file": "src/mactcp/tcp_mactcp.c",
        "second_start": 391,
        "second_end": 408,
        "fragment": "_pb);\n        if (err != noErr) {\n            PT_LOG_WARN(ctx->log, PT_LOG_CAT_NETWORK,\n                \"TCPRcvBfrReturn (listener) failed: %d\", (int)err);\n        }\n        hot->rds_outstanding = 0;\n"
      },
      {
        "lines": 19,
        "tokens": 0,
        "first_file": "src/mactcp/tcp_listen.c",
        "first_start": 323,
        "first_end": 341,
        "second_file": "src/mactcp/tcp_listen.c",
        "second_start": 299,
        "second_end": 310,
        "fragment": " = 0; i < PT_MAX_PEERS; i++) {\n        if (md->tcp_hot[i].state == PT_STREAM_UNUSED) {\n            client_idx = i;\n            break;\n        }\n    }\n\n    if (client_idx < 0) {\n        PT_LOG_WARN(ctx"
      },
      {
        "lines": 12,
        "tokens": 0,
        "first_file": "src/mactcp/tcp_io.c",
        "first_start": 327,
        "first_end": 338,
        "second_file": "src/mactcp/tcp_mactcp.c",
        "second_start": 380,
        "second_end": 391,
        "fragment": "/*\n             * CRITICAL: Return RDS buffers IMMEDIATELY after copying.\n             * MacTCP won't send another ASR until buffers are returned.\n             */\n            if (hot->rds_outstanding)"
      },
      {
        "lines": 9,
        "tokens": 0,
        "first_file": "src/mactcp/tcp_io.c",
        "first_start": 560,
        "first_end": 568,
        "second_file": "src/mactcp/tcp_io.c",
        "second_start": 354,
        "second_end": 362,
        "fragment": "* check TCPStatus for more data. Set ASR flag if data is waiting\n     * so next poll will fetch immediately.\n     */\n    if (messages_processed > 0 && peer->cold.ibuflen < sizeof(peer->cold.ibuf) / 2)"
      },
      {
        "lines": 12,
        "tokens": 0,
        "first_file": "src/mactcp/tcp_io.c",
        "first_start": 675,
        "first_end": 686,
        "second_file": "src/mactcp/tcp_io.c",
        "second_start": 654,
        "second_end": 665,
        "fragment": "(graceful shutdown notification).\n *\n * @param ctx   PeerTalk context\n * @param peer  Peer to notify\n * @return      0 on success, negative error code on failure\n */\nint pt_mactcp_tcp_send_disconnect("
      },
      {
        "lines": 21,
        "tokens": 0,
        "first_file": "src/mactcp/tcp_io.c",
        "first_start": 714,
        "first_end": 734,
        "second_file": "src/mactcp/tcp_io.c",
        "second_start": 80,
        "second_end": 100,
        "fragment": "\n    pt_message_header hdr;\n    uint8_t header_buf[PT_MESSAGE_HEADER_SIZE];\n    uint8_t payload_buf[16];  /* TLV payload max ~12 bytes */\n    uint8_t crc_buf[2];\n    uint16_t crc;\n    int payload_len;"
      },
      {
        "lines": 10,
        "tokens": 0,
        "first_file": "src/mactcp/tcp_io.c",
        "first_start": 788,
        "first_end": 797,
        "second_file": "src/mactcp/tcp_io.c",
        "second_start": 139,
        "second_end": 147,
        "fragment": "h = (unsigned short)payload_len;\n    wds[1].ptr = (Ptr)payload_buf;\n    wds[2].length = 2;\n    wds[2].ptr = (Ptr)crc_buf;\n    wds[3].length = 0;\n    wds[3].ptr = NULL;\n\n    /* Setup send call */\n    p"
      },
      {
        "lines": 13,
        "tokens": 0,
        "first_file": "src/mactcp/tcp_connect.c",
        "first_start": 349,
        "first_end": 361,
        "second_file": "src/mactcp/tcp_io.c",
        "second_start": 85,
        "second_end": 97,
        "fragment": " on success, negative error code on failure\n */\nint pt_mactcp_disconnect(struct pt_context *ctx, struct pt_peer *peer)\n{\n    pt_mactcp_data *md = pt_mactcp_get(ctx);\n    pt_tcp_stream_hot *hot;\n    pt"
      },
      {
        "lines": 14,
        "tokens": 0,
        "first_file": "src/mactcp/tcp_connect.c",
        "first_start": 434,
        "first_end": 447,
        "second_file": "src/mactcp/tcp_connect.c",
        "second_start": 244,
        "second_end": 257,
        "fragment": "close timeout and forces abort if remote is unresponsive.\n *\n * DOD: Uses hot/cold struct split. Single-pass iteration over hot array.\n *\n * @param ctx  PeerTalk context\n * @return     Number of close"
      },
      {
        "lines": 14,
        "tokens": 0,
        "first_file": "src/mactcp/tcp_connect.c",
        "first_start": 456,
        "first_end": 469,
        "second_file": "src/mactcp/tcp_connect.c",
        "second_start": 273,
        "second_end": 284,
        "fragment": " Ticks wrap) */\n        if (cold->pb.ioResult > 0 &&\n            (long)(now - cold->close_start) > (long)PT_CLOSE_TIMEOUT_TICKS) {\n            PT_LOG_WARN(ctx->log, PT_LOG_CAT_CONNECT,\n               "
      },
      {
        "lines": 44,
        "tokens": 0,
        "first_file": "src/mactcp/poll_mactcp.c",
        "first_start": 29,
        "first_end": 72,
        "second_file": "src/mactcp/tcp_listen.c",
        "second_start": 30,
        "second_end": 73,
        "fragment": "tcp_defs.h\"\n#include \"peer.h\"\n#include \"pt_internal.h\"\n#include \"pt_compat.h\"\n#include \"protocol.h\"\n#include \"queue.h\"\n#include \"direct_buffer.h\"\n\n#if defined(PT_PLATFORM_MACTCP)\n\n#include <Devices.h>"
      },
      {
        "lines": 16,
        "tokens": 0,
        "first_file": "src/mactcp/poll_mactcp.c",
        "first_start": 127,
        "first_end": 142,
        "second_file": "src/mactcp/tcp_connect.c",
        "second_start": 266,
        "second_end": 282,
        "fragment": "old *cold,\n                                       struct pt_peer *peer,\n                                       unsigned long now)\n{\n    TCPiopb abort_pb;\n\n    if (peer == NULL)\n        return;\n\n    /*"
      },
      {
        "lines": 13,
        "tokens": 0,
        "first_file": "src/mactcp/poll_mactcp.c",
        "first_start": 144,
        "first_end": 156,
        "second_file": "src/mactcp/tcp_connect.c",
        "second_start": 284,
        "second_end": 296,
        "fragment": "    pt_memset(&abort_pb, 0, sizeof(abort_pb));\n        abort_pb.csCode = TCPAbort;\n        abort_pb.ioCRefNum = md->driver_refnum;\n        abort_pb.tcpStream = hot->stream;\n        PBControlSync((Parm"
      },
      {
        "lines": 7,
        "tokens": 0,
        "first_file": "src/mactcp/poll_mactcp.c",
        "first_start": 174,
        "first_end": 180,
        "second_file": "src/mactcp/tcp_connect.c",
        "second_start": 296,
        "second_end": 302,
        "fragment": " (unsigned)peer->hot.id);\n            pt_mactcp_free_peer_queue(peer->send_queue);\n            pt_mactcp_free_peer_queue(peer->recv_queue);\n            peer->send_queue = NULL;\n            peer->recv_"
      },
      {
        "lines": 10,
        "tokens": 0,
        "first_file": "src/mactcp/poll_mactcp.c",
        "first_start": 198,
        "first_end": 207,
        "second_file": "src/mactcp/tcp_connect.c",
        "second_start": 309,
        "second_end": 318,
        "fragment": "(intptr_t)(idx + 1);\n\n        if (ctx->callbacks.on_peer_connected != NULL) {\n            ctx->callbacks.on_peer_connected((PeerTalk_Context *)ctx,\n                                             peer->h"
      },
      {
        "lines": 14,
        "tokens": 0,
        "first_file": "src/mactcp/poll_mactcp.c",
        "first_start": 335,
        "first_end": 348,
        "second_file": "src/mactcp/tcp_connect.c",
        "second_start": 451,
        "second_end": 465,
        "fragment": "               int idx,\n                                    pt_tcp_stream_hot *hot,\n                                    pt_tcp_stream_cold *cold,\n                                    struct pt_peer *pe"
      }
    ],
    "note": "Showing 20 of 35 duplicates"
  }
}